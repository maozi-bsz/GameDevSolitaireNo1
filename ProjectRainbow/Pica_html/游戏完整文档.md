# 无人红色皮卡的安保之旅 — 最完整游戏文档

> 本文档涵盖游戏的全部机制、配置、数据及扩展说明，为最详尽的参考手册。

---

## 一、游戏概述

### 1.1 基本信息

| 项目 | 说明 |
|------|------|
| 游戏名称 | 无人红色皮卡的安保之旅 |
| 游戏类型 | 文字冒险 + 策略生存 + 资源管理 |
| 入口文件 | `index.html`（主菜单）、`game.html`（主游戏） |
| 视觉风格 | 汉字「皮卡」「轮」「门」等构建的 ASCII 艺术风格 |
| 技术栈 | 原生 JavaScript、Tailwind CSS、Cookie + localStorage |

### 1.2 核心玩法

玩家驾驶一辆红色皮卡在公路上行驶，通过自动生成的文本推进旅程，每 2 行文本可能触发随机事件。玩家需在事件中做出选择，管理燃油、耐久、舒适度三个核心数值，搭载各类乘客，收集物品，应对各种突发状况，尽可能行驶更远，达成多种结局与成就。

---

## 二、核心数值系统

### 2.1 三大属性（0–100）

| 属性 | 说明 | 消耗/变化途径 | 归零结局 |
|------|------|---------------|----------|
| **燃油** | 车辆动力 | 每行文本按里程比例消耗；休息、使用物品可恢复 | **燃油耗尽** |
| **耐久** | 车辆状态 | 事件损伤、恶劣路况、使用修理类物品 | **车辆报废** |
| **舒适** | 乘客满意度 | 事件影响、乘客行为、使用舒适类物品 | **众叛亲离** |

### 2.2 燃油消耗公式

- 每 5 km 消耗 **1.2%** 燃油（`GAME_CONFIG.fuelConsumptionPer5km`）
- 每行文本增加随机 **1～4 km** 里程（`KM_PER_TICK_MIN/MAX`）
- 两行合计约 3～8 km

### 2.3 其他数值

| 数值 | 说明 | 初始/范围 |
|------|------|-----------|
| 金币 | 用于商人、休息等 | 初始 6 |
| 里程 | 本次 / 历史最高 | 0 / localStorage 持久 |
| 后备箱载重 | 物品总重量上限 | 50 |
| 好感度 | 每位乘客独立 | 0～100，默认 50 |

---

## 三、事件系统

### 3.1 触发规则

| 规则 | 配置值 |
|------|--------|
| 文本间隔 | 每 **2 行** 检查一次是否触发事件 |
| 文本速度 | `textSpeed: 1500` ms |
| 昼夜休息 | 每 **25 km** 强制触发 |
| 去重窗口 | 最近 **4 次** 事件不重复同一事件 |
| 休息类限制 | 每 25 km 周期内最多 **3 次** 休息类事件 |

### 3.2 休息类事件 ID

- `rest`（休息站）
- `craft`（工坊）
- `gas_station`（加油站）

### 3.3 默认可触发事件 ID 列表

**遭遇类：** `deer`, `rain`, `saofurry`, `roadblock`, `fog`, `lost_child`, `vagrant`, `exotic_traveler`, `elderly_woman`

**停留/探索类：** `rest`, `craft`, `gas_station`, `abandoned_warehouse`, `abandoned_mine`, `abandoned_farm`, `abandoned_gas_station`

**商人类：** `merchant`, `rare_merchant`, `scavenger`

**特殊/随机类：** `mystery_box`, `lost_traveler`, `stray_cat`, `radio_tower`, `sandstorm`, `abandoned_village`, `firefly_night`, `muddy_downpour`, `wandering_performer`, `meteor_crater`, `deer_nostalgia`, `hunter_and_deer`, `saofurry_chaos`

**解锁事件：** `hunter`（鹿上车后）、`ancient_monument`（探索废弃村庄后）、`tech_merchant`（进入工坊后）、`supply_merchant`（搜刮废弃农场后）

### 3.4 事件效果类型

| 效果 | 格式/说明 |
|------|-----------|
| addItems / removeItems | `[{ id: "物品ID", quantity: 数量 }]` |
| gold | 正数获得，负数消耗 |
| fuel / durability / comfort | 数值变动 |
| addPassenger / removePassenger | 乘客上下车 |
| favor | `{ "鹿": 10, "猎人": -5 }` 指定乘客好感 |
| favorAll | 对所有车上乘客加减相同好感 |
| comfortPerPassenger | 每位乘客减少舒适 |
| setPassengerGetOffMileage | `{ "旅行者": [10, 25] }` 或固定数字 |
| strayCatFeedAndMaybeBoard | 流浪猫喂食计数，第三次上车 |
| unlockEvents | `["event_id"]` |
| openMerchantModal | 打开商人界面 |
| openRestModal | 打开休息界面（使用消耗品） |
| openCraftingModal | 打开合成界面 |
| gameOver | `true` 时游戏结束 |

**复合效果：** `weighted`、`chance`、`choice`、`sequence`、`all`（见 `processEffects`）

**条件：** `condition.requiresPassenger`、`requiresItem`、`minGold`、`notPassenger`

---

## 四、乘客系统

### 4.1 乘客配置总览

| 乘客 | 显示字 | 颜色 | 皮卡位置 |
|------|--------|------|----------|
| 鹿 | 鹿 | #d4a574 | row 1, col 2 |
| 猎人 | 猎、人 | #8b7355 | row 4, col 6-7 |
| 骚福瑞 | 福 | #ff69b4 | row 1, col 10 |
| 旅行者 | 旅 | #34d399 | row 1, col 6 |
| 年迈妇人 | 妇 | #c2185b | row 2, col 8 |
| 猫 | 猫 | #fb923c | row 3, col 4 |
| 流浪艺人 | 艺 | #f59e0b | row 1, col 4 |

### 4.2 乘客特殊机制

| 乘客 | 机制 |
|------|------|
| 旅行者 | 前两次到达目的地会下车；**第三次**到达时永久上车不再下车 |
| 年迈妇人 | 到达目的地下车，获得 **30 金币** 感谢费 |
| 猫 | 需在流浪猫事件中选「喂点零食」累计 **3 次** 才上车 |
| 流浪艺人 | 上车后不再触发流浪艺人事件（`condition: { notPassenger: "流浪艺人" }`） |
| 猎人 | 需先让鹿上车后才解锁猎人事件 |

### 4.3 乘客台词

每次选择后，车上成员会随机说出 `PASSENGER_DIALOGUE_CONFIG` 中配置的台词。每位乘客有独立的 `afterChoice` 数组；无配置时使用 `_default`。

---

## 五、物品系统

### 5.1 消耗品

| 物品 | 重量 | 效果 |
|------|------|------|
| 油桶 | 8 | fuel +30 |
| 修理包 | 5 | durability +25 |
| 坐垫 | 3 | comfort +20 |
| 急救箱 | 4 | durability +10, comfort +15 |
| 零食 | 1 | comfort +10 |
| 高级燃油 | 10 | fuel +50 |
| 八音盒 | 2 | comfort +35（不可堆叠） |
| 轮胎 | 12 | durability +35 |
| 豪华坐垫 | 5 | comfort +35 |
| 水冷系统 | 15 | durability +50（不可堆叠） |
| 超级修理包 | 8 | durability +60 |
| 燃油混合液 | 12 | fuel +80 |
| 医疗补给包 | 6 | durability +25, comfort +35 |
| 舒适组合包 | 7 | comfort +50 |

### 5.2 材料

| 物品 | 重量 |
|------|------|
| 废金属 | 3 |
| 布料 | 1 |
| 草药 | 1 |
| 空罐 | 2 |
| 原油 | 4 |
| 精炼剂 | 2 |
| 电池 | 2 |
| 橡胶 | 3 |
| 皮革 | 2 |
| 铜线 | 1 |

### 5.3 特殊/乘客专属物品

| 物品 | 重量 | 效果 |
|------|------|------|
| 幸运符 | 1 | 特殊（猫好感 85+ 获得） |
| 应急信号弹 | 2 | 特殊 |
| 鹰眼地图 | 1 | 特殊 |
| 鹿角护符 | 1 | fuel +30, comfort +30, durability +25（鹿好感 90+ 获得） |
| 猎人徽章 | 2 | durability +70（猎人好感 90+ 且耐久 ≤40 获得） |
| 骚福瑞手办 | 1 | comfort +80（车内多人好感 70+ 时获得） |
| 和平徽章 | 1 | comfort +20, durability +15（鹿+猎人同时上车且均好感 70+ 获得） |

### 5.4 合成配方（CRAFTING_RECIPES）

| 配方 | 材料 | 产物 | 难度 |
|------|------|------|------|
| 修理包 | 废金属×2 | 修理包×1 | - |
| 坐垫 | 布料×3 | 坐垫×1 | - |
| 急救箱 | 草药×2, 布料×1 | 急救箱×1 | - |
| 油桶 | 空罐×1, 原油×1 | 油桶×1 | - |
| 高级燃油 | 空罐×1, 原油×1, 精炼剂×1 | 高级燃油×1 | - |
| 轮胎 | 橡胶×3, 废金属×1 | 轮胎×1 | 高 |
| 豪华坐垫 | 皮革×2, 布料×3, 精炼剂×1 | 豪华坐垫×1 | 高 |
| 超级修理包 | 废金属×4, 电池×2, 铜线×3 | 超级修理包×1 | 高 |
| 燃油混合液 | 原油×2, 精炼剂×2, 电池×1 | 燃油混合液×1 | 高 |
| 医疗补给包 | 草药×4, 布料×2, 零食×3 | 医疗补给包×1 | 中 |
| 舒适组合包 | 坐垫×1, 零食×5, 布料×2 | 舒适组合包×1 | 低 |

### 5.5 拾取表（LOOT_TABLES）

- **默认**：废金属、布料、草药、空罐、原油、零食、精炼剂
- **稀有**：急救箱、修理包、油桶、精炼剂×2、坐垫、零食×3
- **燃油**：原油×2、油桶、精炼剂、空罐×2
- **食物**：零食、零食×2、草药×2
- **废料**：废金属×2、布料×2、空罐×3

每次拾取随机 1～3 种，按权重抽取。

---

## 六、商人系统

### 6.1 流浪商人

| 物品 | 买价 | 卖价 |
|------|------|------|
| 油桶 | 18 | 9 |
| 修理包 | 14 | 7 |
| 坐垫 | 12 | 6 |
| 零食 | 4 | 2 |
| 急救箱 | 18 | 9 |
| 废金属 | 6 | 3 |
| 布料 | 4 | 2 |
| 草药 | 5 | 2 |
| 空罐 | 5 | 2 |
| 原油 | 10 | 5 |
| 精炼剂 | 20 | 10 |
| 医疗补给包 | 38 | 18 |
| 舒适组合包 | 30 | 14 |

### 6.2 神秘商人

出售高级燃油、八音盒、幸运符、应急信号弹、鹰眼地图、水冷系统、轮胎、豪华坐垫、燃油混合液、超级修理包等高价物品。

### 6.3 技术商人

偏向修理、电气类：修理包、废金属、空罐、精炼剂、油桶、高级燃油、电池、铜线、橡胶、轮胎、水冷系统、超级修理包、燃油混合液。

### 6.4 物资贩子

偏向食物、舒适类：零食、坐垫、布料、草药、急救箱、油桶、皮革、豪华坐垫、医疗补给包、舒适组合包。

---

## 七、结局系统

### 7.1 失败结局

| 结局 ID | 触发条件 |
|---------|----------|
| fuel_empty | 燃油 ≤ 0 |
| durability_zero | 耐久 ≤ 0 |
| comfort_zero | 舒适 ≤ 0 |
| game_over_event | 特定事件（如骚福瑞打爆皮卡） |

### 7.2 特殊结局（按检查顺序）

| 结局 ID | 条件 |
|---------|------|
| **perfect_journey** | 里程 ≥ 300 km，燃油/耐久/舒适均 ≥ 50%，至少 1 名乘客，且未选择无尽模式 |
| **legendary_driver** | 里程 ≥ 500 km，燃油/耐久/舒适均 ≥ 30% |
| **eternal_friendship** | 车上至少 3 人，所有人好感 ≥ 80，里程 ≥ 100 km |
| **collector** | 曾经上车乘客包含全部 7 种，里程 ≥ 150 km |
| **harmony** | 鹿和猎人同时在车上，两者好感均 ≥ 70，里程 ≥ 80 km |
| **lonely_wanderer** | 里程 ≥ 200 km，车上 0 人，燃油/耐久/舒适均 ≥ 40% |

### 7.3 完美旅程无尽模式

达成「完美旅程」结局后可选择「继续无尽模式」，游戏继续推进，不再因该结局结束。

---

## 八、成就系统（完整列表）

### 8.1 里程类（4 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| mileage_50 | 初出茅庐 | 里程 ≥ 50 km |
| mileage_100 | 公路行者 | 里程 ≥ 100 km |
| mileage_200 | 长途司机 | 里程 ≥ 200 km |
| mileage_500 | 公路之王 | 里程 ≥ 500 km |

### 8.2 乘客类（8 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| passenger_deer | 森林之友 | 让鹿上车 |
| passenger_hunter | 猎人同行 | 让猎人上车 |
| passenger_saofurry | 骚福瑞 | 让骚福瑞上车 |
| passenger_traveler | 旅行伙伴 | 让旅行者上车 |
| passenger_elderly | 助人为乐 | 让年迈妇人上车 |
| passenger_cat | 猫奴 | 让流浪猫上车 |
| passenger_performer | 流浪艺人 | 让流浪艺人上车 |
| passenger_all | 满载而归 | 让所有 7 种乘客都上过车 |

### 8.3 好感度类（2 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| favor_high | 人见人爱 | 有乘客好感 ≥ 80 |
| favor_all_high | 完美司机 | 所有乘客好感 ≥ 70 |

### 8.4 物品类（2 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| item_craft | 手工达人 | 合成过物品 |
| item_use | 实用主义 | 使用过消耗品 |

### 8.5 事件类（2 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| event_many | 见多识广 | 触发过 20 个不同事件 |
| merchant_trade | 商人朋友 | 与商人交易过 |

### 8.6 特殊类（2 个）

| ID | 成就名 | 条件 |
|----|--------|------|
| survive_long | 生存专家 | 燃油/耐久/舒适都 < 20% 时继续行驶 10 km |
| perfect_run | 完美旅程 | 单次 ≥ 300 km 且所有属性始终 ≥ 50% |

### 8.7 结局类（隐藏，11 个）

- 4 个失败结局各 1 个成就
- 7 个特殊结局各 1 个成就

成就跨档保存在 `localStorage`（`chinese_truck_adventure_achievements`）。

---

## 九、条件剧情（CONDITIONAL_STORIES_CONFIG）

特殊物品通过满足条件自动获得：

| 剧情 ID | 条件 | 奖励 |
|---------|------|------|
| harmony_badge | 鹿+猎人同车，且好感均 ≥ 70 | 和平徽章×1 |
| deer_gift | 鹿在车，好感 ≥ 90，里程 ≥ 50 | 鹿角护符×1 |
| hunter_gift | 猎人在车，好感 ≥ 90，耐久 ≤ 40 | 猎人徽章×1 |
| performers_song | 流浪艺人在车，好感 ≥ 80，里程 ≥ 100 | 八音盒×1 |
| cat_familiar | 猫在车，好感 ≥ 85 | 幸运符×1 |
| saofurry_party | 骚福瑞在车，车上 ≥ 2 人且所有人好感 ≥ 70 | 骚福瑞手办×1 |

---

## 十、游戏状态（gameState / truckState / inventoryState）

### gameState

- textCount, eventTriggered, triggeredEvents, unlockedEvents, recentEvents
- restCountSinceOvernight, mileage, lastOvernightMileage
- passengerFavor, passengerGetOffMileage, travelerDropOffCount, permanentPassengers
- passengersEverOnBoard, itemsCrafted, itemsUsed, hasTradedWithMerchant
- survivedLowStats, perfectRun, lowStatsMileage
- minFuelDuringRun, minDurabilityDuringRun, minComfortDuringRun
- achievedEndings, triggeredConditionalStories
- sessionAchievements, perfectJourneyEndlessMode

### truckState

- passengers, wheelState, fuel, durability, comfort

### inventoryState

- gold, maxWeight, items

---

## 十一、界面与动效

### 11.1 布局

- **左侧（约 70%）**：状态栏、游戏画面、文本区、车上成员
- **右侧（约 30%）**：金币、里程记录、后备箱

### 11.2 动效

- **screenShake**：耐久变动时约 0.45s 抖动
- **fuelLowFlash**：燃油 ≤ 5 时暗红闪烁
- **durabilityGlitch**：耐久 ≤ 50 时故障特效
- **itemFadeIn**：新物品、新乘客渐显
- **roadMove**：公路字符自右向左滚动
- **truckGlow**：皮卡发光
- **轮子动画**：十字形 ↔ 斜方形切换，间隔 300 ms

### 11.3 公路配置

- 字符池：`["马", "鹿"]`
- 最大显示长度：80

---

## 十二、存档与本地存储

### 12.1 Cookie（`chinese_truck_adventure_save`）

- 有效期：约 10 年
- 内容：gameState、truckState、inventoryState 的序列化

### 12.2 localStorage

| Key | 用途 |
|-----|------|
| chinese_truck_adventure_achievements | 成就 |
| chinese_truck_adventure_endings | 结局达成记录 |
| chinese_truck_adventure_mileage_best | 历史最高里程 |
| chinese_truck_adventure_journey_history | 历史历程（最多 30 条） |

---

## 十三、脚本加载顺序（game.html）

1. game-config, passenger-config, passenger-dialogue-config, conditional-stories-config, truck-style-config, items-config, merchant-config
2. endings-config, achievements-config
3. events-encounter, events-stop, events-merchant, events-special, events-index, inventory-events
4. game-state, save-system, text-control, inventory-system, achievement-system
5. truck-display, event-animation, inventory-display, audio, road
6. event-handler, game-over, text-generation
7. text（主入口）

---

## 十四、全局配置（GAME_CONFIG）

```javascript
triggerInterval: 2,           // 每 2 行触发事件
textSpeed: 1500,              // 文本间隔 ms
overnightRestInterval: 25,     // 昼夜休息间隔 km
recentEventWindow: 4,          // 去重窗口
maxRestPerCycle: 3,            // 休息类事件上限
fuelConsumptionPer5km: 1.2,    // 燃油消耗
initialGold: 6,                // 初始金币
cookieExpiryDays: 3650,
cookieName: "chinese_truck_adventure_save"
```

---

## 十五、扩展指南

### 15.1 新增事件

1. 在 `events/` 对应文件中按现有格式添加事件对象
2. 确保在 `events-index.js` 的合并源中
3. 需要解锁时，在其它事件的 `effects.unlockEvents` 中加入新事件 ID

### 15.2 新增乘客

1. 在 `passenger-config.js` 的 `PASSENGER_CONFIG` 中增加配置
2. 在 `passenger-dialogue-config.js` 中增加 `afterChoice`
3. 事件中使用 `addPassenger: "乘客名"`

### 15.3 新增物品

1. 在 `items-config.js` 的 `ITEMS_CONFIG` 中添加
2. 需要合成时，在 `CRAFTING_RECIPES` 中添加配方

### 15.4 新增成就

在 `achievements-config.js` 的 `ACHIEVEMENTS_CONFIG` 中添加，需提供 `id`、`title`、`description`、`icon`、`check` 函数。

### 15.5 新增结局

在 `endings-config.js` 的 `ENDINGS_CONFIG` 中添加；在 `game-over.js` 的 `checkSpecialEndings()` 或 `checkGameOverConditions()` 中加入判定逻辑。

---

## 十六、主菜单功能

- **START**：进入 game.html
- **重置游戏**：清除 Cookie 与相关 localStorage
- **成就**：查看所有成就及解锁状态
- **历史历程**：查看最近约 30 次旅途记录（结局、里程、乘客、成就等）

---

**文档版本**：3.0（最完整版）  
**更新日期**：2026 年 2 月
